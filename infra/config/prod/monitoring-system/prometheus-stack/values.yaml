namespace: prod

# Configuration for kube-prometheus-stack subchart
kube-prometheus-stack:
  # Grafana configuration for PRODUCTION
  grafana:
    adminPassword: "SecurePassword123!"
    
    grafana.ini:
      server:
        domain: "prod.grafana.local"
        root_url: "http://prod.grafana.local:8000/"
      security:
        admin_user: "admin"
        cookie_secure: false  # Changed to false for HTTP
        cookie_samesite: "strict"
    
    ingress:
      enabled: true
      ingressClassName: nginx
      annotations:
        nginx.ingress.kubernetes.io/ssl-redirect: "false"  # Changed to false
        nginx.ingress.kubernetes.io/force-ssl-redirect: "false"  # Changed to false
        nginx.ingress.kubernetes.io/backend-protocol: "HTTP"
      hosts:
        - "prod.grafana.local"
      path: /
    
    additionalDataSources:
      - name: Prometheus
        type: prometheus
        url: http://prometheus-stack-prod-kube-prom-prometheus:9090
        access: proxy
        isDefault: true
    
    resources:
      requests:
        cpu: "200m"
        memory: "256Mi"
      limits:
        cpu: "500m"
        memory: "512Mi"

  # Prometheus production settings
  prometheus:
    prometheusSpec:
      retention: "30d"
      serviceMonitorSelector:
        matchLabels:
          release: prometheus-stack-prod
      resources:
        requests:
          cpu: "500m"
          memory: "2Gi"
        limits:
          cpu: "2000m"
          memory: "4Gi"
      storageSpec:
        volumeClaimTemplate:
          spec:
            resources:
              requests:
                storage: 50Gi

  # DISABLE node-exporter in prod to avoid conflict
  prometheus-node-exporter:
    enabled: false

  # Disable alertmanager for now
  alertmanager:
    enabled: false